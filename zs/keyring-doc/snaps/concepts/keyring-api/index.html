<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-snaps docs-doc-id-concepts/keyring-api">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Keyring API | MetaMask developer documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.metamask.io/zs/keyring-doc/snaps/concepts/keyring-api/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-snaps-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-snaps-current"><meta data-rh="true" property="og:title" content="Keyring API | MetaMask developer documentation"><meta data-rh="true" name="description" content="Learn about the Snaps Keyring API."><meta data-rh="true" property="og:description" content="Learn about the Snaps Keyring API."><link data-rh="true" rel="icon" href="/zs/keyring-doc/img/metamask-fox.svg"><link data-rh="true" rel="canonical" href="https://docs.metamask.io/zs/keyring-doc/snaps/concepts/keyring-api/"><link data-rh="true" rel="alternate" href="https://docs.metamask.io/zs/keyring-doc/snaps/concepts/keyring-api/" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.metamask.io/zs/keyring-doc/snaps/concepts/keyring-api/" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://AWX4QVM59R-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="MetaMask developer documentation" href="/zs/keyring-doc/opensearch.xml">



<script src="https://cmp.osano.com/AzZMxHTbQDOQD8c1J/a2e89f0e-f467-4542-bfea-30ea2c1a6648/osano.js"></script>
<script src="https://plausible.io/js/script.js" defer="defer" data-domain="docs.metamask.io"></script><link rel="stylesheet" href="/zs/keyring-doc/assets/css/styles.e6e71b24.css">
<link rel="preload" href="/zs/keyring-doc/assets/js/runtime~main.04249ae6.js" as="script">
<link rel="preload" href="/zs/keyring-doc/assets/js/main.97a1f01e.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/zs/keyring-doc/"><div class="navbar__logo"><img src="/zs/keyring-doc/img/metamask-logo.svg" alt="MetaMask logo" class="themedImage_ToTc themedImage--light_HNdA" width="150"><img src="/zs/keyring-doc/img/metamask-logo-dark.svg" alt="MetaMask logo" class="themedImage_ToTc themedImage--dark_i4oU" width="150"></div><b class="navbar__title text--truncate"> │ ‎ Documentation</b></a><a class="navbar__item navbar__link" href="/zs/keyring-doc/wallet/">Wallet</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/zs/keyring-doc/snaps/">Snaps</a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/zs/keyring-doc/snaps/">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="/zs/keyring-doc/snaps/get-started/">Get started</a><button aria-label="Toggle the collapsible sidebar category &#x27;Get started&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zs/keyring-doc/snaps/get-started/install-snaps/">Install Snaps</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zs/keyring-doc/snaps/get-started/quickstart/">Snaps quickstart</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/zs/keyring-doc/snaps/how-to/">How to</a><button aria-label="Toggle the collapsible sidebar category &#x27;How to&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/zs/keyring-doc/snaps/concepts/">Concepts</a><button aria-label="Toggle the collapsible sidebar category &#x27;Concepts&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zs/keyring-doc/snaps/concepts/anatomy/">Snaps anatomy</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zs/keyring-doc/snaps/concepts/lifecycle/">Snaps lifecycle</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zs/keyring-doc/snaps/concepts/user-interface/">Snaps user interface</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zs/keyring-doc/snaps/concepts/execution-environment/">Snaps execution environment</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zs/keyring-doc/snaps/concepts/design-guidelines/">Snaps design guidelines</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/zs/keyring-doc/snaps/concepts/keyring-api/">Keyring API</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/zs/keyring-doc/snaps/tutorials/">Tutorials</a><button aria-label="Toggle the collapsible sidebar category &#x27;Tutorials&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/zs/keyring-doc/snaps/reference/">Reference</a><button aria-label="Toggle the collapsible sidebar category &#x27;Reference&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Keyring API</h1><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</div><div class="admonitionContent_S0QG"><p>This API is only available in MetaMask Flask, the canary distribution of MetaMask.</p></div></div><p>The Keyring API brings deeper integration for custom EVM accounts inside MetaMask. Before the Keyring API, custom EVM accounts such MPC accounts, etc. needed to be shown separately, in a companion Dapp. Now these custom accounts can live alongside regular MetaMask accounts in the UI. Dapps can connect to them using <code>eth_requestAccounts</code>, and seamlessly interact with them using <code>eth_sendTransaction</code>, <code>personal_sign</code>, etc.</p><p>Using the <a href="/zs/keyring-doc/snaps/concepts/keyring-api/">Snaps Keyring API</a>, you can integrate custom EVM accounts directly in MetaMask. These accounts will be displayed alongside MetaMask-controlled accounts in the UI:</p><p><img loading="lazy" alt="Keyring snap accounts in Metamask UI" src="/zs/keyring-doc/assets/images/accounts-ui-f345af5d51513180efda9ccce62d9001.png" width="712" height="1198" class="img_ev3q"></p><p>Creating a keyring snap allows Dapps to connect to its accounts and submit requests like <code>personal_sign</code>, <code>eth_sendTransaction</code>, etc. as if these were regular, MetaMask-controlled accounts.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="terminology">Terminology<a href="#terminology" class="hash-link" aria-label="Direct link to Terminology" title="Direct link to Terminology">​</a></h2><p>Let&#x27;s introduce some terminology used across the Keyring API:</p><ul><li><strong>Blockchain account</strong>: An object in a single blockchain, representing an account, with its balance, nonce, etc.</li><li><strong>Request</strong>: A request sent by a Dapp to MetaMask.</li><li><strong>Keyring account</strong>: An account model that represents one or more blockchain accounts.</li><li><strong>Keyring snap</strong>: A snap that implements the Keyring API.</li><li><strong>Keyring request</strong>: A request from MetaMask to a keyring snap, to perform an action on or using a keyring account. It wraps the original request sent by the Dapp and adds some metadata to it.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="components-diagram">Components diagram<a href="#components-diagram" class="hash-link" aria-label="Direct link to Components diagram" title="Direct link to Components diagram">​</a></h2><p>When interacting with accounts managed by a Keyring snap, we will encounter the following components:</p><p><img loading="lazy" alt="Keyring snap component diagram" src="/zs/keyring-doc/assets/images/components-diagram-fe20de86d108f422853c9c00649d3f10.png" width="500" height="398" class="img_ev3q"></p><ul><li><strong>User</strong>: The web3 user interacting with the snap, the Dapp, and MetaMask.</li><li><strong>Dapp</strong>: The web3 application that is requesting an action to be performed on an account.</li><li><strong>MetaMask</strong>: The web3 provider that dApps connect to. It routes requests to the keyring snaps and lets the user perform some level of account management.</li><li><strong>Snap</strong>: A snap that implements the Keyring API to manage the user&#x27;s accounts, and to handle requests that use these accounts.</li><li><strong>Snap UI</strong>: The snap&#x27;s UI component that allows the user to interact with the snap to perform custom operations on accounts and requests.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="implementing-a-keyring-class">Implementing a <code>Keyring</code> class<a href="#implementing-a-keyring-class" class="hash-link" aria-label="Direct link to implementing-a-keyring-class" title="Direct link to implementing-a-keyring-class">​</a></h2><p>The first step for creating a Keyring snap is to implement the <a href="/zs/keyring-doc/snaps/reference/keyring-api/modules/#keyring"><code>Keyring</code> interface</a>. This interface describes all the methods necessary to make your custom EVM accounts work inside MetaMask with your own logic. The next sections will go over the methods of the <code>Keyring</code> interface by describing the different flows that it handles.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="snap-account-creation-flow">Snap account creation flow<a href="#snap-account-creation-flow" class="hash-link" aria-label="Direct link to Snap account creation flow" title="Direct link to Snap account creation flow">​</a></h2><p>The first interaction between users and your Keyring snap will be the snap account creation process. Here is a diagram of the process:</p><p><img loading="lazy" alt="Keyring snap account creation flow" src="/zs/keyring-doc/assets/images/create-account-flow-425c4feb8388212d3a55b843a40e5146.png" width="871" height="695" class="img_ev3q"></p><p>The MetaMask account selection modal has an option called &quot;Add snap account&quot;:</p><p><img loading="lazy" alt="add snap account option" src="/zs/keyring-doc/assets/images/add-snap-account-a0b0b4854e79cd62fa300b40e9e2f9ca.png" width="682" height="1058" class="img_ev3q"></p><p>This option will show a list of keyring snaps, but will ultimately redirect the user to the companion Dapp for your Keyring snap. That is, a Dapp that contains all the UI to configure and manage the Keyring snap.</p><p>On that Dapp, you&#x27;ll present a custom user interface allowing the user configure their custom EVM account. The Dapp will make use of the <a href="/zs/keyring-doc/snaps/reference/keyring-api/classes/KeyringSnapRpcClient/#createaccount"><code>KeyringSnapRpcClient</code>&#x27;s <code>createAccount</code> method</a>, which will call your <code>Keyring</code> class&#x27; method of the same name. An example of this can be found in the <a href="https://github.com/MetaMask/snap-simple-keyring/blob/d3f7f0156c59059c995fea87f90a3d0ad3a4c135/packages/site/src/pages/index.tsx#L136" target="_blank" rel="noopener noreferrer">Simple keyring snap companion Dapp</a>.</p><p>In your <code>Keyring</code> class&#x27; <code>createAccount</code> method, your responsibility is to create the account based on the parameters that were passed to you. Your snap has to keep track of the accounts that it creates, which can be done using <a href="/zs/keyring-doc/snaps/reference/rpc-api/#snap_managestate"><code>snap_manageState</code></a>. Once your snap has created an account, it should notify MetaMask using the <a href="/zs/keyring-doc/snaps/reference/rpc-api/#createaccount"><code>snap_manageAccounts</code> <code>createAccount</code> method</a>. An example of this process can be found in the <a href="https://github.com/MetaMask/snap-simple-keyring/blob/d3f7f0156c59059c995fea87f90a3d0ad3a4c135/packages/snap/src/keyring.ts#L61" target="_blank" rel="noopener noreferrer">Simple keyring snap code</a>.</p><p>Once your snap has created an account, that account can be used to sign messages and transactions. In the following sections we&#x27;ll look at how this can be done.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="synchronous-signing-flow">Synchronous signing flow<a href="#synchronous-signing-flow" class="hash-link" aria-label="Direct link to Synchronous signing flow" title="Direct link to Synchronous signing flow">​</a></h2><p>Your Keyring snap will implement the simple flow if it&#x27;s able to sign transactions directly. This would be the case if the snap doesn&#x27;t need a third-party such as a hardware key or a second account&#x27;s signature, as would be the case for a threshold signature scheme. The flow would look like this:</p><p><img loading="lazy" alt="Synchronous signing flow" src="/zs/keyring-doc/assets/images/synchronous-flow-86d162f98ddac87d1fcfd21fed2d161d.png" width="2044" height="1260" class="img_ev3q"></p><p>For a full example of a simple keyring snap, see <a href="https://github.com/MetaMask/snap-simple-keyring" target="_blank" rel="noopener noreferrer"><code>snap-simple-keyring</code> on GitHub</a>.</p><p>The flow starts when a Dapp calls a method such as <code>personal_sign</code> or <code>eth_signTransaction</code>, or when the user initiates a new funds transfer from the MetaMask UI. At that point, MetaMask will detect that this interaction is requested for an account controlled by your Keyring snap.</p><p>After the user approves the transaction in the UI, MetaMask will call the <code>submitRequest</code> method of your <code>Keyring</code> class. <code>submitRequest</code> will receive the original RPC request, and will need to return a <a href="/zs/keyring-doc/snaps/reference/keyring-api/modules/#submitrequestresponsestruct"><code>SubmitRequestResponse</code></a> with <code>pending</code> set to <code>false</code>, and <code>result</code> set to the requested signature.</p><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</div><div class="admonitionContent_S0QG"><p>If your Keyring snap receives an <code>eth_sendTransaction</code> request, you must treat it like an <code>eth_signTransaction</code> request. That is, your snap is responsible for providing the signature in the response, and MetaMask is responsible for broadcasting the transaction.</p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="asynchronous-signing-flow">Asynchronous signing flow<a href="#asynchronous-signing-flow" class="hash-link" aria-label="Direct link to Asynchronous signing flow" title="Direct link to Asynchronous signing flow">​</a></h2><p>If your keyring snap implements a more complex scheme, e.g. threshold signing, then the flow will be more involved, and more <code>Keyring</code> methods will be used. The diagram below will help you visualize the flow:</p><p><img loading="lazy" alt="Asynchronous signing flow" src="/zs/keyring-doc/assets/images/asynchronous-flow-b1f803e0e7329c394f17910c67b9350d.png" width="1822" height="1512" class="img_ev3q"></p><p>The flow starts the same way: a request to sign a transaction or arbitrary data is initiated by a Dapp or by the user. After approval, your snap&#x27;s <code>submitRequest</code> method is called.</p><p>Since your snap won&#x27;t answer the request directly, it should store the pending request in its internal state using <a href="/zs/keyring-doc/snaps/reference/rpc-api/#snap_managestate"><code>snap_manageState</code></a>. This list of pending requests should be returned when the <code>listRequests</code> or <code>getRequest</code> methods of your <code>Keyring</code> class are called.</p><p>After storing the pending request, your snap should direct the user to a &quot;companion Dapp&quot; – a Dapp that serves as UI for the snap – where the rest of the flow can continue. Your snap can do this by creating a pop-up using <a href="/zs/keyring-doc/snaps/reference/rpc-api/#snap_dialog"><code>snap_dialog</code></a> instructing the user to go to the companion Dapp&#x27;s URL.</p><p>The Dapp will list your snap&#x27;s pending requests using an RPC call facilitated by the <a href="/zs/keyring-doc/snaps/reference/keyring-api/classes/KeyringSnapRpcClient/#listrequests"><code>KeyringSnapRpcClient</code>&#x27;s <code>listRequests</code> method</a>. The user can then act on those requests using whatever process applies to the snap.</p><p>Once the signing process is completed, the companion Dapp will resolve the request using the <a href="/zs/keyring-doc/snaps/reference/keyring-api/classes/KeyringSnapRpcClient/#approverequest"><code>KeyringSnapRpcClient</code>&#x27;s <code>approveRequest</code> method</a>, which will call the snap&#x27;s <code>Keyring</code> method of the same name. This method receives the request&#x27;s ID, as well as the final result.</p><p>When <code>approveRequest</code> gets called, it can resolve the pending request by using the <a href="/zs/keyring-doc/snaps/reference/rpc-api/#submitresponse"><code>snap_manageAccounts</code>&#x27; <code>submitResponse</code> method</a>.</p><p>Find out more about <a href="/zs/keyring-doc/snaps/tutorials/integrate-custom-evm-accounts/">how to implement custom EVM accounts using the Keyring API</a>.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/MetaMask/metamask-docs/edit/main/snaps/concepts/keyring-api.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/zs/keyring-doc/snaps/concepts/design-guidelines/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Snaps design guidelines</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/zs/keyring-doc/snaps/tutorials/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Tutorials</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#terminology" class="table-of-contents__link toc-highlight">Terminology</a></li><li><a href="#components-diagram" class="table-of-contents__link toc-highlight">Components diagram</a></li><li><a href="#implementing-a-keyring-class" class="table-of-contents__link toc-highlight">Implementing a <code>Keyring</code> class</a></li><li><a href="#snap-account-creation-flow" class="table-of-contents__link toc-highlight">Snap account creation flow</a></li><li><a href="#synchronous-signing-flow" class="table-of-contents__link toc-highlight">Synchronous signing flow</a></li><li><a href="#asynchronous-signing-flow" class="table-of-contents__link toc-highlight">Asynchronous signing flow</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Wallet</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/zs/keyring-doc/wallet/">Introduction</a></li><li class="footer__item"><a class="footer__link-item" href="/zs/keyring-doc/wallet/category/how-to/">How to guides</a></li><li class="footer__item"><a class="footer__link-item" href="/zs/keyring-doc/wallet/concepts/">Concepts</a></li><li class="footer__item"><a class="footer__link-item" href="/zs/keyring-doc/wallet/tutorials/">Tutorials</a></li><li class="footer__item"><a class="footer__link-item" href="/zs/keyring-doc/wallet/reference/">Reference</a></li></ul></div><div class="col footer__col"><div class="footer__title">Snaps</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/zs/keyring-doc/snaps/">Introduction</a></li><li class="footer__item"><a class="footer__link-item" href="/zs/keyring-doc/snaps/get-started/">Get started</a></li><li class="footer__item"><a class="footer__link-item" href="/zs/keyring-doc/snaps/how-to/">How to guides</a></li><li class="footer__item"><a class="footer__link-item" href="/zs/keyring-doc/snaps/tutorials/">Tutorials</a></li><li class="footer__item"><a class="footer__link-item" href="/zs/keyring-doc/snaps/reference/">Reference</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://discord.gg/consensys" target="_blank" rel="noopener noreferrer" class="footer__link-item">Consensys Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/MetaMask/metamask-docs" target="_blank" rel="noopener noreferrer" class="footer__link-item">Documentation GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/MetaMask/metamask-extension/" target="_blank" rel="noopener noreferrer" class="footer__link-item">MetaMask wallet GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/MetaMask/snaps-monorepo" target="_blank" rel="noopener noreferrer" class="footer__link-item">Snaps GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Legal</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://consensys.net/privacy-policy/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Privacy Policy<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://consensys.net/terms-of-use/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Terms of Use<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://metamask.io/cla/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Contributor License Agreement<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><button id="manage-cookie-btn">Manage cookie</button></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://metamask.io/" rel="noopener noreferrer" class="footerLogoLink_BH7S"><img src="/zs/keyring-doc/img/metamask-logo.svg" alt="MetaMask logo" class="themedImage_ToTc themedImage--light_HNdA footer__logo" width="250"><img src="/zs/keyring-doc/img/metamask-logo-dark.svg" alt="MetaMask logo" class="themedImage_ToTc themedImage--dark_i4oU footer__logo" width="250"></a></div><div class="footer__copyright">© 2023 MetaMask • A Consensys Formation</div></div></div></footer></div>
<script src="/zs/keyring-doc/assets/js/runtime~main.04249ae6.js"></script>
<script src="/zs/keyring-doc/assets/js/main.97a1f01e.js"></script>
</body>
</html>